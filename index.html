<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>C√Ä PH√ä SANG ‚Äî POS</title>

  <!-- CSS: th·ª© t·ª± quan tr·ªçng -->
  <link rel="stylesheet" href="base.css" />
  <link rel="stylesheet" href="layout.css" />
  <link rel="stylesheet" href="components.css" />
  <link rel="stylesheet" href="mobile.css" />
</head>
<body>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  TOAST CONTAINER
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="toast-container"></div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  BOTTOM NAV (mobile only ‚Äî ·∫©n tr√™n desktop qua CSS)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<nav id="bottom-nav" style="display:none">
  <button class="bnav-btn active" data-view="tables" onclick="App.showView('tables')">
    <svg viewBox="0 0 24 24"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></svg>
    S∆† ƒê·ªí B√ÄN
  </button>
  <button class="bnav-btn" data-view="menu" onclick="App.showView('menu')">
    <svg viewBox="0 0 24 24"><path d="M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"/><rect x="9" y="3" width="6" height="4" rx="1"/><line x1="9" y1="12" x2="15" y2="12"/><line x1="9" y1="16" x2="12" y2="16"/></svg>
    TH·ª∞C ƒê∆†N
  </button>
  <button class="bnav-btn" data-view="history" onclick="App.showView('history')">
    <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
    L·ªäCH S·ª¨
  </button>
  <button class="bnav-btn" data-view="reports" onclick="App.showView('reports')">
    <svg viewBox="0 0 24 24"><line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/></svg>
    B√ÅO C√ÅO
  </button>
  <button class="bnav-btn" data-view="settings" onclick="App.showView('settings')">
    <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
    C√ÄI ƒê·∫∂T
  </button>
</nav>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  MODALS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->

<!-- THANH TO√ÅN QR -->
<div id="modal-qr" class="modal-overlay">
  <div class="modal-box sm">
    <p class="modal-title text-orange" style="text-align:center">THANH TO√ÅN QR</p>
    <p id="qr-amount" class="qr-amount">0ƒë</p>
    <div class="qr-image-wrap">
      <img id="qr-image" src="" alt="VietQR" />
    </div>
    <div class="qr-info">
      <p>Ng√¢n h√†ng: <b id="qr-bank">‚Äî</b></p>
      <p>STK: <strong id="qr-account">‚Äî</strong></p>
      <p>T√™n: <b id="qr-owner">‚Äî</b></p>
    </div>
    <div class="modal-footer">
      <button class="btn btn-slate btn-full"
        onclick="document.getElementById('modal-qr').classList.remove('show')">
        ƒê√≥ng
      </button>
      <button class="btn btn-green btn-full"
        onclick="Payment.confirmQR()">
        ƒê√£ nh·∫≠n ti·ªÅn
      </button>
    </div>
  </div>
</div>

<!-- CH·ª§P BILL -->
<div id="modal-camera" class="modal-overlay">
  <div class="modal-box md">
    <p class="modal-title">CH·ª§P BILL</p>

    <!-- Stage: Live camera -->
    <div id="stage-live" class="cam-stage">
      <video id="cam-video" autoplay playsinline muted></video>
      <button class="btn btn-orange btn-full btn-lg"
        onclick="Camera.shoot()">
        CH·ª§P ·∫¢NH
      </button>
    </div>

    <!-- Stage: Preview sau ch·ª•p -->
    <div id="stage-preview" class="cam-stage">
      <img id="cam-preview" src="" alt="Preview" />
      <div class="cam-btn-row">
        <button class="btn btn-slate" onclick="Camera.retake()">Ch·ª•p l·∫°i</button>
        <button class="btn btn-blue"  onclick="Camera.download()">T·∫£i v·ªÅ m√°y</button>
        <button class="btn btn-green" onclick="Camera.saveToSystem()">L∆∞u h·ªá th·ªëng</button>
      </div>
    </div>

    <!-- Stage: L·ªói camera -->
    <div id="stage-error" class="cam-stage">
      <p id="cam-error-msg" class="cam-error-msg">Kh√¥ng th·ªÉ m·ªü camera.</p>
    </div>

    <canvas id="cam-canvas" style="display:none"></canvas>

    <button class="btn btn-slate btn-full" style="margin-top:12px"
      onclick="Camera.close()">
      ƒê√≥ng
    </button>
  </div>
</div>

<!-- FORM TH√äM / S·ª¨A M√ìN -->
<div id="modal-menu-form" class="modal-overlay">
  <div class="modal-box md">
    <p id="mform-title" class="modal-title">Th√™m M√≥n M·ªõi</p>

    <div class="form-row">
      <label>T√™n m√≥n *</label>
      <input id="mform-name" class="inp" placeholder="T√™n m√≥n..." />
    </div>
    <div class="form-row">
      <label>Gi√° (ƒë·ªìng)</label>
      <input id="mform-price" class="inp" type="number" placeholder="15000" />
    </div>
    <div class="form-row">
      <label>Danh m·ª•c</label>
      <select id="mform-cat" class="inp">
        <!-- ƒêi·ªÅn b·ªüi JS -->
      </select>
    </div>
    <div class="form-row">
      <label>M√¥ t·∫£ (tu·ª≥ ch·ªçn)</label>
      <input id="mform-desc" class="inp" placeholder="M√¥ t·∫£ ng·∫Øn..." />
    </div>
    <div class="form-row">
      <label class="checkbox-row">
        <input id="mform-active" type="checkbox" checked />
        ƒêang b√°n
      </label>
    </div>

    <div class="modal-footer">
      <button class="btn btn-slate btn-full"
        onclick="document.getElementById('modal-menu-form').classList.remove('show')">
        Hu·ª∑
      </button>
      <button class="btn btn-orange btn-full"
        onclick="MenuMgr.save()">
        L∆∞u
      </button>
    </div>
  </div>
</div>

<!-- CONFIRM -->
<div id="modal-confirm" class="modal-overlay">
  <div class="modal-box sm">
    <p id="confirm-msg" class="confirm-msg">B·∫°n c√≥ ch·∫Øc kh√¥ng?</p>
    <div class="modal-footer">
      <button id="confirm-no"  class="btn btn-slate btn-full">Hu·ª∑</button>
      <button id="confirm-yes" class="btn btn-red   btn-full">X√°c nh·∫≠n</button>
    </div>
  </div>
</div>


<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  APP
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="app">

  <!-- HEADER -->
  <header id="header">
    <div class="header-brand">
      <span id="header-store">C√Ä PH√ä SANG</span>
      <span id="header-date"></span>
    </div>
    <nav id="nav">
      <button class="nav-btn active" data-view="tables" onclick="App.showView('tables')">
        S∆† ƒê·ªí B√ÄN <span class="nav-shortcut">[1]</span>
      </button>
      <button class="nav-btn" data-view="menu" onclick="App.showView('menu')">
        TH·ª∞C ƒê∆†N <span class="nav-shortcut">[2]</span>
      </button>
      <button class="nav-btn" data-view="history" onclick="App.showView('history')">
        L·ªäCH S·ª¨ <span class="nav-shortcut">[3]</span>
      </button>
      <button class="nav-btn" data-view="reports" onclick="App.showView('reports')">
        B√ÅO C√ÅO <span class="nav-shortcut">[4]</span>
      </button>
      <button class="nav-btn" data-view="settings" onclick="App.showView('settings')">
        C√ÄI ƒê·∫∂T <span class="nav-shortcut">[5]</span>
      </button>
    </nav>
  </header>

  <!-- MAIN -->
  <div id="main">

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê S∆† ƒê·ªí B√ÄN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="view-tables" class="view show" style="overflow-y:auto">
      <div style="padding:16px">
        <!-- Legend -->
        <div class="legend">
          <div class="legend-item">
            <span class="legend-dot" style="background:#475569"></span> Tr·ªëng
          </div>
          <div class="legend-item">
            <span class="legend-dot" style="background:#451a03;border:1px solid #f59e0b"></span> ƒêang ph·ª•c v·ª•
          </div>
          <div class="legend-item">
            <span class="legend-dot" style="background:#1a0000;border:1px solid #f87171"></span> Ch·ªù thanh to√°n
          </div>
        </div>

        <!-- Zones (sinh b·ªüi JS) -->
        <div id="zones-container"></div>

        <!-- Stats -->
        <div class="stats-row">
          <div class="stat-card">
            <div id="stat-empty" class="stat-num" style="color:#94a3b8">0</div>
            <div class="stat-label">B√†n tr·ªëng</div>
          </div>
          <div class="stat-card">
            <div id="stat-serving" class="stat-num" style="color:#fbbf24">0</div>
            <div class="stat-label">ƒêang ph·ª•c v·ª•</div>
          </div>
          <div class="stat-card">
            <div id="stat-waiting" class="stat-num" style="color:#f87171">0</div>
            <div class="stat-label">Ch·ªù thanh to√°n</div>
          </div>
        </div>
      </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ORDER ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="view-order" class="view">

      <!-- B√™n tr√°i: l∆∞·ªõi ch·ªçn m√≥n -->
      <div class="menu-panel">
        <div id="order-cat-bar" class="cat-bar">
          <!-- ƒêi·ªÅn b·ªüi JS -->
        </div>
        <div class="order-search-bar">
          <input id="order-search" class="inp inp-sm" placeholder="T√¨m m√≥n nhanh..."
            oninput="Render._renderMenuGrid({search: this.value})" />
        </div>
        <div id="order-menu-grid" class="menu-grid">
          <!-- ƒêi·ªÅn b·ªüi JS -->
        </div>
      </div>

      <!-- Toggle button (mobile only) ‚Äî n·∫±m d∆∞·ªõi menu-panel, tr√™n order-panel -->
      <button id="order-panel-toggle" style="display:none"
        onclick="MobileUI.toggleOrderPanel()">
        <span>üõí Xem ƒë∆°n h√†ng</span>
        <span id="toggle-total-val" class="toggle-total">0ƒë</span>
        <span class="toggle-arrow">‚ñ≤</span>
      </button>

      <!-- B√™n ph·∫£i: order summary -->
      <div class="order-panel" id="order-panel-drawer">
        <div class="order-panel-header">
          <div>
            <span id="order-table-id" class="order-table-label">B√ÄN ‚Äî</span>
            <span id="order-status-badge" class="status-badge">Tr·ªëng</span>
          </div>
          <button class="btn btn-slate btn-sm"
            onclick="App.showView('tables')">
            Quay l·∫°i
          </button>
        </div>

        <div id="order-items" class="order-items-list">
          <!-- ƒêi·ªÅn b·ªüi JS -->
        </div>

        <div class="order-footer">
          <!-- VAT -->
          <div class="vat-row">
            <label class="checkbox-row">
              <input id="vat-checkbox" type="checkbox"
                onchange="Order.toggleVat(this.checked); Render._renderOrderSummary()" />
              <span id="vat-label">VAT 8%</span>
            </label>
          </div>

          <!-- T·ªïng -->
          <div class="total-row">
            <span class="total-label">T·ªîNG</span>
            <span id="order-total" class="total-amount">0ƒë</span>
          </div>

          <!-- N√∫t action -->
          <div class="action-grid">
            <button id="btn-pay-cash" class="btn btn-green" disabled
              onclick="Payment.payByCash()">
              TI·ªÄN M·∫∂T
            </button>
            <button id="btn-pay-qr" class="btn btn-blue" disabled
              onclick="Payment.showQR()">
              QR BANK
            </button>
            <button id="btn-wait" class="btn btn-amber" disabled
              onclick="Order.setWaiting(); Toast.info('Chuy·ªÉn sang ch·ªù thanh to√°n'); App.showView('tables')">
              CH·ªú TT
            </button>
            <button id="btn-print" class="btn btn-slate" disabled
              onclick="Payment.printReceipt()">
              IN H√ìA ƒê∆†N
            </button>
            <button class="btn btn-purple"
              onclick="Camera.open()">
              CH·ª§P BILL
            </button>
            <button class="btn btn-red"
              onclick="showConfirm('Hu·ª∑ to√†n b·ªô order b√†n n√†y?', () => { Order.cancel(); Toast.info('ƒê√£ hu·ª∑ order'); App.showView('tables'); Render.tables(); })">
              HU·ª∂ ORDER
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê QU·∫¢N L√ù TH·ª∞C ƒê∆†N ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="view-menu" class="view view-padded" style="overflow-y:auto">
      <div class="menu-toolbar">
        <h2 class="view-title" style="margin:0">QU·∫¢N L√ù TH·ª∞C ƒê∆†N</h2>
        <div style="display:flex;gap:8px">
          <label class="btn btn-teal btn-sm" style="cursor:pointer">
            IMPORT CSV
            <input type="file" accept=".csv" style="display:none"
              onchange="MenuMgr.importCSV(this.files[0]); this.value=''" />
          </label>
          <button class="btn btn-orange btn-sm"
            onclick="MenuMgr.openAdd()">
            + TH√äM M√ìN
          </button>
        </div>
      </div>

      <div class="menu-filters">
        <input id="mmgmt-search" class="inp" style="flex:1;min-width:180px"
          placeholder="T√¨m m√≥n..."
          oninput="Render.menuMgmt({search:this.value})" />
        <select id="mmgmt-cat" class="inp" style="width:200px"
          onchange="Render.menuMgmt({cat:this.value})">
          <!-- ƒêi·ªÅn b·ªüi JS -->
        </select>
      </div>

      <div class="table-wrap">
        <table>
          <thead>
            <tr>
              <th>T√™n m√≥n</th>
              <th>Danh m·ª•c</th>
              <th>Gi√°</th>
              <th>Tr·∫°ng th√°i</th>
              <th>Thao t√°c</th>
            </tr>
          </thead>
          <tbody id="menu-tbody">
            <!-- ƒêi·ªÅn b·ªüi JS -->
          </tbody>
        </table>
      </div>
      <p style="color:var(--dim);font-size:.7rem;margin-top:8px">
        CSV format: T√™n,Gi√°,Danh m·ª•c,M√¥ t·∫£ ‚Äî m·ªói m√≥n m·ªôt d√≤ng
      </p>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê L·ªäCH S·ª¨ ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="view-history" class="view view-padded" style="overflow-y:auto">
      <h2 class="view-title">L·ªäCH S·ª¨ ORDER</h2>
      <div class="hist-toolbar">
        <input id="hist-date" type="date" class="inp" style="width:auto"
          onchange="Render.history(this.value)" />
        <span id="hist-summary" style="color:var(--muted);font-size:.82rem"></span>
      </div>
      <div id="history-list">
        <!-- ƒêi·ªÅn b·ªüi JS -->
      </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê B√ÅO C√ÅO ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="view-reports" class="view view-padded" style="overflow-y:auto">
      <h2 class="view-title">B√ÅO C√ÅO DOANH THU</h2>

      <!-- Period tabs -->
      <div class="rep-period-bar">
        <button class="rep-period-btn active" data-period="day"
          onclick="this.parentNode.querySelectorAll('.rep-period-btn').forEach(b=>b.classList.remove('active')); this.classList.add('active'); Render.reports('day')">
          H√¥m nay
        </button>
        <button class="rep-period-btn" data-period="week"
          onclick="this.parentNode.querySelectorAll('.rep-period-btn').forEach(b=>b.classList.remove('active')); this.classList.add('active'); Render.reports('week')">
          Tu·∫ßn n√†y
        </button>
        <button class="rep-period-btn" data-period="month"
          onclick="this.parentNode.querySelectorAll('.rep-period-btn').forEach(b=>b.classList.remove('active')); this.classList.add('active'); Render.reports('month')">
          Th√°ng n√†y
        </button>
      </div>

      <!-- KPI cards -->
      <div class="rep-kpi-grid">
        <div class="kpi-card wide">
          <div class="kpi-label">T·ªïng doanh thu</div>
          <div id="rep-revenue" class="kpi-value text-orange">0ƒë</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">S·ªë ƒë∆°n h√†ng</div>
          <div id="rep-count" class="kpi-value">0</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">Trung b√¨nh / ƒë∆°n</div>
          <div id="rep-avg" class="kpi-value">‚Äî</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">QR Transfer</div>
          <div id="rep-qr" class="kpi-value text-blue">0ƒë</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">Ti·ªÅn m·∫∑t</div>
          <div id="rep-cash" class="kpi-value text-green">0ƒë</div>
        </div>
      </div>

      <!-- Top items -->
      <h3 style="color:var(--text);font-weight:900;font-size:1rem;margin-bottom:12px">
        TOP M√ìN B√ÅN CH·∫†Y
      </h3>
      <div class="table-wrap">
        <div id="rep-top-items">
          <!-- ƒêi·ªÅn b·ªüi JS -->
        </div>
      </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê C√ÄI ƒê·∫∂T ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="view-settings" class="view view-padded" style="overflow-y:auto">
      <h2 class="view-title">C√ÄI ƒê·∫∂T H·ªÜ TH·ªêNG</h2>

      <div class="settings-wrap">

        <!-- Th√¥ng tin qu√°n -->
        <div class="section">
          <p class="section-title">TH√îNG TIN QU√ÅN</p>
          <div class="settings-row">
            <label>T√™n qu√°n</label>
            <input id="cfg-store-name" class="inp" placeholder="T√™n qu√°n..." />
          </div>
          <div class="settings-row">
            <label>ƒê·ªãa ch·ªâ</label>
            <input id="cfg-address" class="inp" placeholder="ƒê·ªãa ch·ªâ qu√°n..." />
          </div>
        </div>

        <!-- VietQR -->
        <div class="section" style="border-color:rgba(249,115,22,.35)">
          <p class="section-title text-orange">VIETQR ‚Äî THANH TO√ÅN</p>
          <div class="settings-row">
            <label>M√£ ng√¢n h√†ng (agribank / vietcombank / tcb / mb / vpbank...)</label>
            <input id="cfg-bank-code" class="inp" placeholder="agribank" />
          </div>
          <div class="settings-row">
            <label>S·ªë t√†i kho·∫£n</label>
            <input id="cfg-bank-acc" class="inp" placeholder="7400215025420" />
          </div>
          <div class="settings-row">
            <label>T√™n ch·ªß t√†i kho·∫£n</label>
            <input id="cfg-bank-owner" class="inp" placeholder="NGUYEN THANH SANG" />
          </div>
        </div>

        <!-- VAT -->
        <div class="section">
          <p class="section-title">THU·∫æ VAT</p>
          <div class="settings-row">
            <label class="checkbox-row">
              <input id="cfg-vat-default" type="checkbox" />
              B·∫≠t VAT m·∫∑c ƒë·ªãnh cho ƒë∆°n h√†ng m·ªõi
            </label>
          </div>
          <div class="settings-row">
            <label>Thu·∫ø su·∫•t (%)</label>
            <input id="cfg-vat-rate" class="inp" type="number" style="width:100px" value="8" />
          </div>
        </div>

        <!-- L∆∞u -->
        <div style="margin-bottom:16px">
          <button class="btn btn-orange btn-lg btn-full"
            onclick="App.saveSettings()">
            L∆ØU C√ÄI ƒê·∫∂T
          </button>
        </div>

        <!-- Backup -->
        <div class="section">
          <p class="section-title">SAO L∆ØU & KH√îI PH·ª§C</p>
          <div class="backup-btns">
            <button class="btn btn-green"
              onclick="App.exportBackup()">
              Xu·∫•t backup JSON
            </button>
            <label class="btn btn-blue" style="cursor:pointer">
              Kh√¥i ph·ª•c JSON
              <input type="file" accept=".json" style="display:none"
                onchange="App.importBackup(this.files[0]); this.value=''" />
            </label>
            <button class="btn btn-red"
              onclick="App.resetAll()">
              Xo√° t·∫•t c·∫£
            </button>
          </div>
          <p style="color:var(--dim);font-size:.7rem;margin-top:10px">
            D·ªØ li·ªáu l∆∞u trong localStorage tr√¨nh duy·ªát. Backup th∆∞·ªùng xuy√™n ƒë·ªÉ tr√°nh m·∫•t d·ªØ li·ªáu!
          </p>
        </div>

        <!-- Ph√≠m t·∫Øt -->
        <div class="section">
          <p class="section-title">PH√çM T·∫ÆT</p>
          <div class="shortcut-grid">
            <div class="shortcut-item"><kbd>1</kbd> S∆° ƒë·ªì b√†n</div>
            <div class="shortcut-item"><kbd>2</kbd> Th·ª±c ƒë∆°n</div>
            <div class="shortcut-item"><kbd>3</kbd> L·ªãch s·ª≠</div>
            <div class="shortcut-item"><kbd>4</kbd> B√°o c√°o</div>
            <div class="shortcut-item"><kbd>5</kbd> C√†i ƒë·∫∑t</div>
            <div class="shortcut-item"><kbd>Esc</kbd> ƒê√≥ng modal / v·ªÅ b√†n</div>
          </div>
        </div>

        <!-- Th·ªëng k√™ -->
        <div class="section">
          <p class="section-title">TH·ªêNG K√ä H·ªÜ TH·ªêNG</p>
          <div class="stats-mini-grid">
            <div class="stats-mini-card">
              <div id="stats-menu-count" class="stats-mini-num">0</div>
              <div class="stats-mini-label">M√≥n trong menu</div>
            </div>
            <div class="stats-mini-card">
              <div id="stats-order-count" class="stats-mini-num">0</div>
              <div class="stats-mini-label">T·ªïng ƒë∆°n h√†ng</div>
            </div>
            <div class="stats-mini-card">
              <div id="stats-paid-count" class="stats-mini-num">0</div>
              <div class="stats-mini-label">ƒê√£ thanh to√°n</div>
            </div>
          </div>
        </div>

      </div><!-- /settings-wrap -->
    </div><!-- /view-settings -->

  </div><!-- /main -->
</div><!-- /app -->


<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  JS: th·ª© t·ª± load quan tr·ªçng!
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<script src="config.js"></script>   <!-- 1. CONFIG tr∆∞·ªõc ti√™n -->
<script src="db.js"></script>       <!-- 2. DB layer -->
<script src="data.js"></script>     <!-- 3. D·ªØ li·ªáu demo + constants -->
<script src="utils.js"></script>    <!-- 4. Helper functions -->
<script src="order.js"></script>    <!-- 5. Order + Tables logic -->
<script src="menu.js"></script>     <!-- 6. Menu CRUD -->
<script src="payment.js"></script>  <!-- 7. Thanh to√°n QR + print -->
<script src="camera.js"></script>   <!-- 8. Ch·ª•p bill -->
<script src="reports.js"></script>  <!-- 9. B√°o c√°o -->
<script src="render.js"></script>   <!-- 10. V·∫Ω giao di·ªán -->
<script src="app.js"></script>      <!-- 11. App controller (cu·ªëi c√πng) -->

<!-- Kh·ªüi t·∫°o zone grids trong HTML (ƒë·ªÉ render.js ƒëi·ªÅn v√†o) -->
<script>
  // T·∫°o zone blocks sau khi DOM s·∫µn s√†ng
  document.addEventListener("DOMContentLoaded", () => {
    const container = document.getElementById("zones-container");
    CONFIG.zones.forEach(zone => {
      container.innerHTML += `
        <div class="zone-block">
          <div class="zone-title">KHU ${zone.id} ‚Äî ${zone.name}</div>
          <div id="zone-grid-${zone.id}" class="tables-grid"></div>
        </div>
      `;
    });
  });
</script>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  MOBILE UI CONTROLLER
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<script>
const MobileUI = {
  isMobile() {
    return window.innerWidth < 640;
  },

  // Sync bottom nav active state v·ªõi current view
  syncNav(viewName) {
    if (!this.isMobile()) return;
    document.querySelectorAll('.bnav-btn').forEach(btn => {
      btn.classList.toggle('active', btn.dataset.view === viewName);
    });
  },

  // Hi·ªán/·∫©n toggle button khi v√†o order view
  onOrderView(show) {
    const toggle = document.getElementById('order-panel-toggle');
    if (!toggle) return;
    if (this.isMobile() && show) {
      toggle.style.display = 'flex';
    } else {
      toggle.style.display = 'none';
      this.closeOrderPanel();
    }
  },

  // M·ªü/ƒë√≥ng order panel drawer
  toggleOrderPanel() {
    const panel = document.getElementById('order-panel-drawer');
    const toggle = document.getElementById('order-panel-toggle');
    if (!panel || !toggle) return;
    const isOpen = panel.classList.contains('panel-open');
    if (isOpen) {
      this.closeOrderPanel();
    } else {
      panel.classList.add('panel-open');
      toggle.classList.add('open');
      toggle.querySelector('span:first-child').textContent = '‚úï ƒê√≥ng ƒë∆°n h√†ng';
    }
  },

  closeOrderPanel() {
    const panel = document.getElementById('order-panel-drawer');
    const toggle = document.getElementById('order-panel-toggle');
    if (panel) panel.classList.remove('panel-open');
    if (toggle) {
      toggle.classList.remove('open');
      const firstSpan = toggle.querySelector('span:first-child');
      if (firstSpan) firstSpan.textContent = 'üõí Xem ƒë∆°n h√†ng';
    }
  },

  // C·∫≠p nh·∫≠t t·ªïng ti·ªÅn hi·ªÉn th·ªã tr√™n toggle button
  updateToggleTotal(total) {
    const el = document.getElementById('toggle-total-val');
    if (el) el.textContent = total || '0ƒë';
  },

  // Kh·ªüi t·∫°o: hook v√†o App.showView n·∫øu c√≥
  init() {
    // Responsive bottom nav visibility
    const showBottomNav = () => {
      const nav = document.getElementById('bottom-nav');
      if (nav) {
        nav.style.display = this.isMobile() ? 'flex' : 'none';
      }
    };
    showBottomNav();
    window.addEventListener('resize', showBottomNav);

    // Patch App.showView ƒë·ªÉ sync bottom nav
    if (typeof App !== 'undefined' && App.showView) {
      const orig = App.showView.bind(App);
      App.showView = (viewName) => {
        orig(viewName);
        MobileUI.syncNav(viewName);
        MobileUI.onOrderView(viewName === 'order');
      };
    }

    // ƒê√≥ng order panel khi b·∫•m Escape
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') MobileUI.closeOrderPanel();
    });
  }
};

// Kh·ªüi t·∫°o sau khi app load
document.addEventListener('DOMContentLoaded', () => {
  // ƒê·ª£i app.js init xong
  setTimeout(() => MobileUI.init(), 200);
});
</script>

</body>
</html>
